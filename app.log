2025-03-14 10:03:38,942 - INFO - Подключение к базе данных установлено.
2025-03-14 10:03:39,266 - INFO - Таблицы проверены/созданы.
2025-03-14 10:03:39,588 - INFO - Индексы проверены/созданы.
2025-03-14 10:03:40,180 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 10:03:40,190 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 10:03:40,230 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 10:03:40,244 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 10:03:40,256 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 10:03:41,928 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 10:03:41,928 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 10:03:42,299 - INFO - Start polling
2025-03-14 10:03:42,396 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 10:03:49,103 - INFO - Получение названий групп из расписания.
2025-03-14 10:03:50,014 - INFO - Update id=860671606 is handled. Duration 1391 ms by bot id=7732473607
2025-03-14 10:04:07,999 - WARNING - Received SIGINT signal
2025-03-14 10:04:08,000 - INFO - Polling stopped for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 10:04:08,000 - INFO - Polling stopped
2025-03-14 10:04:08,418 - INFO - Подключение к базе данных закрыто.
2025-03-14 10:06:47,539 - INFO - Подключение к базе данных установлено.
2025-03-14 10:06:47,845 - INFO - Таблицы проверены/созданы.
2025-03-14 10:06:48,147 - INFO - Индексы проверены/созданы.
2025-03-14 10:06:48,744 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 10:06:48,754 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 10:06:48,774 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 10:06:48,792 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 10:06:48,801 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 10:06:50,398 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 10:06:50,399 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 10:06:50,762 - INFO - Start polling
2025-03-14 10:06:50,857 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 10:06:54,250 - INFO - Получение названий групп из расписания.
2025-03-14 10:06:55,044 - INFO - Update id=860671607 is handled. Duration 1245 ms by bot id=7732473607
2025-03-14 10:07:14,753 - INFO - Подключение к базе данных установлено.
2025-03-14 10:07:15,076 - INFO - Таблицы проверены/созданы.
2025-03-14 10:07:15,396 - INFO - Индексы проверены/созданы.
2025-03-14 10:07:15,986 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 10:07:15,995 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 10:07:16,004 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 10:07:16,014 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 10:07:16,059 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 10:07:17,848 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 10:07:17,848 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 10:07:18,214 - INFO - Start polling
2025-03-14 10:07:18,308 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 10:07:20,146 - INFO - Получение названий групп из расписания.
2025-03-14 10:07:20,958 - INFO - Update id=860671608 is handled. Duration 1293 ms by bot id=7732473607
2025-03-14 10:07:57,732 - INFO - Подключение к базе данных установлено.
2025-03-14 10:07:58,030 - INFO - Таблицы проверены/созданы.
2025-03-14 10:07:58,328 - INFO - Индексы проверены/созданы.
2025-03-14 10:07:58,914 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 10:07:58,923 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 10:07:58,942 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 10:07:58,975 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 10:07:58,984 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 10:08:00,588 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 10:08:00,589 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 10:08:00,957 - INFO - Start polling
2025-03-14 10:08:01,051 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 10:10:04,922 - INFO - Подключение к базе данных установлено.
2025-03-14 10:10:05,222 - INFO - Таблицы проверены/созданы.
2025-03-14 10:10:05,517 - INFO - Индексы проверены/созданы.
2025-03-14 10:10:06,186 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 10:10:06,196 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 10:10:06,205 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 10:10:06,215 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 10:10:06,250 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 10:10:07,854 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 10:10:07,855 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 10:10:08,216 - INFO - Start polling
2025-03-14 10:10:08,310 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 10:10:10,870 - INFO - Update id=860671609 is not handled. Duration 440 ms by bot id=7732473607
2025-03-14 10:10:10,870 - ERROR - Cause exception while process update id=860671609 by bot id=7732473607
AttributeError: 'ScheduleManager' object has no attribute 'get_group_name'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/middlewares/album.py", line 21, in __call__
    await handler(message, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/main.py", line 85, in main_menu
    group_name = await schedule_manager.get_group_name()
AttributeError: 'ScheduleManager' object has no attribute 'get_group_name'
2025-03-14 10:10:53,087 - INFO - Подключение к базе данных установлено.
2025-03-14 10:10:53,409 - INFO - Таблицы проверены/созданы.
2025-03-14 10:10:53,727 - INFO - Индексы проверены/созданы.
2025-03-14 10:10:54,389 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 10:10:54,399 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 10:10:54,409 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 10:10:54,418 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 10:10:54,452 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 10:10:56,137 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 10:10:56,137 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 10:10:56,499 - INFO - Start polling
2025-03-14 10:10:56,593 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 10:10:59,962 - INFO - Получение названий групп из расписания.
2025-03-14 10:11:00,441 - INFO - Update id=860671610 is not handled. Duration 955 ms by bot id=7732473607
2025-03-14 10:11:00,442 - ERROR - Cause exception while process update id=860671610 by bot id=7732473607
ValidationError: 2 validation errors for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<Record group_name='КСК-2024-1/3' min_id=1>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
callback_data
  Input should be a valid string [type=string_type, input_value=<Record group_name='КСК-2024-1/3' min_id=1>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/middlewares/album.py", line 21, in __call__
    await handler(message, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/main.py", line 90, in main_menu
    reply_markup=kb_groups(group_name)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 62, in kb_groups
    return inline_builder(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 31, in inline_builder
    [
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 32, in <listcomp>
    builder.button(text=txt, callback_data=cb)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 323, in button
    self._button(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 256, in _button
    button = self._button_type(**kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<Record group_name='КСК-2024-1/3' min_id=1>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
callback_data
  Input should be a valid string [type=string_type, input_value=<Record group_name='КСК-2024-1/3' min_id=1>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-14 10:13:13,020 - INFO - Подключение к базе данных установлено.
2025-03-14 10:13:13,336 - INFO - Таблицы проверены/созданы.
2025-03-14 10:13:13,647 - INFO - Индексы проверены/созданы.
2025-03-14 10:13:14,295 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 10:13:14,305 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 10:13:14,330 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 10:13:14,352 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 10:13:14,361 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 10:13:16,040 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 10:13:16,040 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 10:13:16,409 - INFO - Start polling
2025-03-14 10:13:16,503 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 10:13:17,788 - INFO - Получение названий групп из расписания.
2025-03-14 10:13:18,597 - INFO - Update id=860671611 is handled. Duration 1274 ms by bot id=7732473607
2025-03-14 10:13:25,356 - INFO - Пользователь 5124967932 добавлен.
2025-03-14 10:13:25,476 - INFO - Update id=860671612 is handled. Duration 942 ms by bot id=7732473607
2025-03-14 10:13:32,478 - INFO - Update id=860671613 is not handled. Duration 2 ms by bot id=7732473607
2025-03-14 10:13:32,478 - ERROR - Cause exception while process update id=860671613 by bot id=7732473607
AttributeError: 'ScheduleManager' object has no attribute 'get_schedule_data'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 58, in get_schedules
    data = await schedule_manager.get_schedule_data(user_id, date)
AttributeError: 'ScheduleManager' object has no attribute 'get_schedule_data'
2025-03-14 17:41:12,946 - INFO - Подключение к базе данных установлено.
2025-03-14 17:41:13,273 - INFO - Таблицы проверены/созданы.
2025-03-14 17:41:13,588 - INFO - Индексы проверены/созданы.
2025-03-14 17:41:14,298 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 17:41:14,308 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 17:41:14,317 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 17:41:14,326 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 17:41:14,374 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 17:41:16,083 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 17:41:16,083 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 17:41:16,453 - INFO - Start polling
2025-03-14 17:41:16,549 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 17:41:36,233 - INFO - Update id=860671614 is handled. Duration 791 ms by bot id=7732473607
2025-03-14 17:41:42,071 - INFO - Получение названия группы пользователя.
2025-03-14 17:41:42,538 - INFO - Update id=860671615 is not handled. Duration 469 ms by bot id=7732473607
2025-03-14 17:41:42,538 - ERROR - Cause exception while process update id=860671615 by bot id=7732473607
TypeError: ScheduleManager.get_schedule_by_group() takes 2 positional arguments but 3 were given
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 61, in get_schedules
    data = await schedule_manager.get_schedule_by_group(user_id, date)
TypeError: ScheduleManager.get_schedule_by_group() takes 2 positional arguments but 3 were given
2025-03-14 20:54:36,286 - INFO - Подключение к базе данных установлено.
2025-03-14 20:54:36,616 - INFO - Таблицы проверены/созданы.
2025-03-14 20:54:36,934 - INFO - Индексы проверены/созданы.
2025-03-14 20:54:37,893 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 20:54:37,903 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 20:54:37,911 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 20:54:37,921 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 20:54:37,936 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 20:54:39,670 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 20:54:39,671 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 20:54:40,041 - INFO - Start polling
2025-03-14 20:54:40,137 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 20:54:53,876 - WARNING - Received SIGINT signal
2025-03-14 20:54:53,876 - INFO - Polling stopped for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 20:54:53,876 - INFO - Polling stopped
2025-03-14 20:54:54,295 - INFO - Подключение к базе данных закрыто.
2025-03-14 20:55:00,040 - INFO - Подключение к базе данных установлено.
2025-03-14 20:55:00,345 - INFO - Таблицы проверены/созданы.
2025-03-14 20:55:00,644 - INFO - Индексы проверены/созданы.
2025-03-14 20:55:01,605 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 20:55:01,615 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 20:55:01,624 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 20:55:01,646 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 20:55:01,666 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 20:55:03,288 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 20:55:03,288 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 20:55:03,663 - INFO - Start polling
2025-03-14 20:55:03,763 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 20:57:42,904 - INFO - Подключение к базе данных установлено.
2025-03-14 20:57:43,886 - INFO - Таблицы проверены/созданы.
2025-03-14 20:57:44,644 - INFO - Индексы проверены/созданы.
2025-03-14 20:57:45,397 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 20:57:45,406 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 20:57:45,416 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 20:57:45,426 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 20:57:45,435 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 20:57:47,067 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 20:57:47,067 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 20:57:47,476 - INFO - Start polling
2025-03-14 20:57:47,573 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 20:57:55,262 - INFO - Получение названий групп из расписания.
2025-03-14 20:57:56,083 - INFO - Update id=860671616 is handled. Duration 1268 ms by bot id=7732473607
2025-03-14 20:58:03,447 - INFO - Update id=860671617 is not handled. Duration 743 ms by bot id=7732473607
2025-03-14 20:58:03,447 - ERROR - Cause exception while process update id=860671617 by bot id=7732473607
UndefinedColumnError: column "user_name" of relation "users" does not exist
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/main.py", line 107, in get_group_name
    await welcome_message(callback_query, user_service, group)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/main.py", line 62, in welcome_message
    await user_service.add_user(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/utils/db/user_service.py", line 25, in add_user
    await self.pool.execute(query, user_id, user_name, group_name)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/pool.py", line 566, in execute
    return await con.execute(query, *args, timeout=timeout)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 2004, in _do_execute
    stmt = await self._get_statement(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "user_name" of relation "users" does not exist
2025-03-14 21:06:41,336 - INFO - Подключение к базе данных установлено.
2025-03-14 21:06:42,081 - INFO - Таблицы проверены/созданы.
2025-03-14 21:06:42,567 - INFO - Индексы проверены/созданы.
2025-03-14 21:06:43,437 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:06:43,447 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:06:43,457 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 21:06:43,484 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 21:06:43,493 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:06:45,161 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 21:06:45,161 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 21:06:45,535 - INFO - Start polling
2025-03-14 21:06:45,632 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 21:06:50,550 - INFO - Получение названий групп из расписания.
2025-03-14 21:06:51,526 - INFO - Update id=860671618 is handled. Duration 1444 ms by bot id=7732473607
2025-03-14 21:06:54,345 - INFO - Update id=860671619 is not handled. Duration 794 ms by bot id=7732473607
2025-03-14 21:06:54,345 - ERROR - Cause exception while process update id=860671619 by bot id=7732473607
UndefinedColumnError: column "user_nick" of relation "users" does not exist
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/main.py", line 107, in get_group_name
    await welcome_message(callback_query, user_service, group)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/main.py", line 62, in welcome_message
    await user_service.add_user(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/utils/db/user_service.py", line 25, in add_user
    await self.pool.execute(query, user_id, user_name, group_name)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/pool.py", line 566, in execute
    return await con.execute(query, *args, timeout=timeout)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 2004, in _do_execute
    stmt = await self._get_statement(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "user_nick" of relation "users" does not exist
2025-03-14 21:07:46,652 - INFO - Подключение к базе данных установлено.
2025-03-14 21:07:46,955 - INFO - Таблицы проверены/созданы.
2025-03-14 21:07:47,253 - INFO - Индексы проверены/созданы.
2025-03-14 21:07:47,917 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 21:07:47,927 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 21:07:47,965 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:07:47,975 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:07:47,984 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:07:49,559 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 21:07:49,559 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 21:07:49,927 - INFO - Start polling
2025-03-14 21:07:50,023 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 21:07:51,718 - INFO - Получение названий групп из расписания.
2025-03-14 21:07:52,544 - INFO - Update id=860671620 is handled. Duration 1273 ms by bot id=7732473607
2025-03-14 21:07:54,678 - INFO - Update id=860671621 is not handled. Duration 738 ms by bot id=7732473607
2025-03-14 21:07:54,679 - ERROR - Cause exception while process update id=860671621 by bot id=7732473607
PostgresSyntaxError: INSERT has more expressions than target columns
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/main.py", line 107, in get_group_name
    await welcome_message(callback_query, user_service, group)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/main.py", line 62, in welcome_message
    await user_service.add_user(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/utils/db/user_service.py", line 25, in add_user
    await self.pool.execute(query, user_id, user_name, group_name)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/pool.py", line 566, in execute
    return await con.execute(query, *args, timeout=timeout)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 2004, in _do_execute
    stmt = await self._get_statement(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.PostgresSyntaxError: INSERT has more expressions than target columns
2025-03-14 21:09:44,684 - INFO - Подключение к базе данных установлено.
2025-03-14 21:09:44,987 - INFO - Таблицы проверены/созданы.
2025-03-14 21:09:45,290 - INFO - Индексы проверены/созданы.
2025-03-14 21:09:45,963 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 21:09:45,973 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:09:45,983 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 21:09:45,993 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:09:46,026 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:09:47,631 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 21:09:47,631 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 21:09:48,000 - INFO - Start polling
2025-03-14 21:09:48,098 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 21:09:49,652 - INFO - Получение названий групп из расписания.
2025-03-14 21:09:50,512 - INFO - Update id=860671622 is handled. Duration 1307 ms by bot id=7732473607
2025-03-14 21:09:52,920 - INFO - Пользователь 5124967932 добавлен.
2025-03-14 21:09:53,046 - INFO - Update id=860671623 is handled. Duration 924 ms by bot id=7732473607
2025-03-14 21:10:07,574 - INFO - Подключение к базе данных установлено.
2025-03-14 21:10:07,889 - INFO - Таблицы проверены/созданы.
2025-03-14 21:10:08,202 - INFO - Индексы проверены/созданы.
2025-03-14 21:10:08,804 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:10:08,837 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:10:08,861 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:10:27,270 - INFO - Подключение к базе данных установлено.
2025-03-14 21:10:27,579 - INFO - Таблицы проверены/созданы.
2025-03-14 21:10:27,877 - INFO - Индексы проверены/созданы.
2025-03-14 21:10:28,488 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:10:28,498 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:10:28,508 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:10:28,518 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 21:10:28,533 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 21:10:30,156 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 21:10:30,157 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 21:10:30,528 - INFO - Start polling
2025-03-14 21:10:30,627 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 21:10:32,214 - INFO - Update id=860671624 is not handled. Duration 1 ms by bot id=7732473607
2025-03-14 21:10:32,214 - ERROR - Cause exception while process update id=860671624 by bot id=7732473607
TypeError: send_profile() missing 1 required positional argument: 'admin_manager'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/profile.py", line 115, in profile
    await send_profile(callback_query.from_user.id, user_service, callback_query=callback_query)
TypeError: send_profile() missing 1 required positional argument: 'admin_manager'
2025-03-14 21:10:45,352 - INFO - Получение названия группы пользователя.
2025-03-14 21:10:46,095 - INFO - Update id=860671625 is not handled. Duration 745 ms by bot id=7732473607
2025-03-14 21:10:46,095 - ERROR - Cause exception while process update id=860671625 by bot id=7732473607
DataError: invalid input for query argument $1: [<Record group_name='ССА-2022-2'>] (expected str, got list)
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/text.pyx", line 29, in asyncpg.pgproto.pgproto.text_encode
  File "asyncpg/pgproto/./codecs/text.pyx", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size
TypeError: expected str, got list

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 61, in get_schedules
    data = await schedule_manager.get_schedule_by_group(group_name)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/utils/db/schedule_manager.py", line 112, in get_schedule_by_group
    records = await self.pool.fetch(query, group_name)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/pool.py", line 597, in fetch
    return await con.fetch(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: [<Record group_name='ССА-2022-2'>] (expected str, got list)
2025-03-14 21:11:34,088 - INFO - Подключение к базе данных установлено.
2025-03-14 21:11:34,392 - INFO - Таблицы проверены/созданы.
2025-03-14 21:11:34,692 - INFO - Индексы проверены/созданы.
2025-03-14 21:11:35,294 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 21:11:35,304 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:11:35,314 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:11:35,339 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 21:11:35,349 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:11:37,001 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 21:11:37,001 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 21:11:37,370 - INFO - Start polling
2025-03-14 21:11:37,475 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 21:11:49,866 - INFO - Получение названия группы пользователя.
2025-03-14 21:11:50,315 - INFO - Update id=860671626 is not handled. Duration 451 ms by bot id=7732473607
2025-03-14 21:11:50,315 - ERROR - Cause exception while process update id=860671626 by bot id=7732473607
TypeError: list indices must be integers or slices, not str
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 61, in get_schedules
    data = await schedule_manager.get_schedule_by_group(group_name['group_name'])
TypeError: list indices must be integers or slices, not str
2025-03-14 21:13:26,676 - INFO - Подключение к базе данных установлено.
2025-03-14 21:13:26,999 - INFO - Таблицы проверены/созданы.
2025-03-14 21:13:27,319 - INFO - Индексы проверены/созданы.
2025-03-14 21:13:27,990 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 21:13:28,000 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:13:28,009 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:13:28,041 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:13:28,051 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 21:13:29,765 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 21:13:29,765 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 21:13:30,134 - INFO - Start polling
2025-03-14 21:13:30,231 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 21:14:09,153 - INFO - Получение названия группы пользователя.
2025-03-14 21:14:10,109 - INFO - Update id=860671627 is handled. Duration 958 ms by bot id=7732473607
2025-03-14 21:15:02,597 - INFO - Подключение к базе данных установлено.
2025-03-14 21:15:02,910 - INFO - Таблицы проверены/созданы.
2025-03-14 21:15:03,214 - INFO - Индексы проверены/созданы.
2025-03-14 21:15:03,880 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:15:03,890 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 21:15:03,898 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:15:03,915 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:15:03,931 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 21:15:05,585 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 21:15:05,585 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 21:15:05,960 - INFO - Start polling
2025-03-14 21:15:06,059 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 21:15:07,193 - INFO - Получение названия группы пользователя.
2025-03-14 21:15:08,115 - INFO - Update id=860671628 is not handled. Duration 924 ms by bot id=7732473607
2025-03-14 21:15:08,115 - ERROR - Cause exception while process update id=860671628 by bot id=7732473607
KeyError: 'data'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 63, in get_schedules
    print(data[0]['data'])
KeyError: 'data'
2025-03-14 21:15:49,180 - INFO - Подключение к базе данных установлено.
2025-03-14 21:15:49,496 - INFO - Таблицы проверены/созданы.
2025-03-14 21:15:49,808 - INFO - Индексы проверены/созданы.
2025-03-14 21:15:50,415 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-14 21:15:50,424 - INFO - Для даты 2025-03-17 отсутствует расписание.
2025-03-14 21:15:50,436 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-14 21:15:50,446 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-14 21:15:50,476 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-14 21:15:52,128 - INFO - Добавлено/обновлено 96 записей.
2025-03-14 21:15:52,128 - INFO - Данные расписания сохранены в БД, количество записей: 96.
2025-03-14 21:15:52,499 - INFO - Start polling
2025-03-14 21:15:52,594 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-14 21:15:54,254 - INFO - Получение названия группы пользователя.
2025-03-14 21:15:55,196 - INFO - Update id=860671629 is handled. Duration 945 ms by bot id=7732473607
2025-03-16 19:03:50,500 - INFO - Подключение к базе данных установлено.
2025-03-16 19:03:50,836 - INFO - Таблицы проверены/созданы.
2025-03-16 19:03:51,159 - INFO - Индексы проверены/созданы.
2025-03-16 19:03:52,188 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-16 19:03:52,198 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-16 19:03:52,207 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-16 19:03:52,224 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-16 19:03:52,233 - INFO - Для даты 2025-03-21 отсутствует расписание.
2025-03-16 19:03:52,243 - INFO - Для даты 2025-03-22 отсутствует расписание.
2025-03-16 19:03:53,772 - INFO - Добавлено/обновлено 48 записей.
2025-03-16 19:03:53,772 - INFO - Данные расписания сохранены в БД, количество записей: 48.
2025-03-16 19:03:54,177 - INFO - Start polling
2025-03-16 19:03:54,282 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:04:03,534 - INFO - Update id=860671630 is handled. Duration 993 ms by bot id=7732473607
2025-03-16 19:04:06,317 - INFO - Получение названия группы пользователя.
2025-03-16 19:04:07,287 - INFO - Update id=860671631 is not handled. Duration 973 ms by bot id=7732473607
2025-03-16 19:04:07,288 - ERROR - Cause exception while process update id=860671631 by bot id=7732473607
TypeError: list indices must be integers or slices, not str
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 59, in get_schedules
    await send_schedule_data(callback_query, data)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 31, in send_schedule_data
    for pair in json.loads(data['subjects']):
TypeError: list indices must be integers or slices, not str
2025-03-16 19:04:59,972 - INFO - Подключение к базе данных установлено.
2025-03-16 19:05:00,302 - INFO - Таблицы проверены/созданы.
2025-03-16 19:05:00,630 - INFO - Индексы проверены/созданы.
2025-03-16 19:05:01,667 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-16 19:05:01,676 - INFO - Для даты 2025-03-21 отсутствует расписание.
2025-03-16 19:05:01,686 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-16 19:05:01,711 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-16 19:05:01,770 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-16 19:05:01,808 - INFO - Для даты 2025-03-22 отсутствует расписание.
2025-03-16 19:05:03,209 - INFO - Добавлено/обновлено 48 записей.
2025-03-16 19:05:03,209 - INFO - Данные расписания сохранены в БД, количество записей: 48.
2025-03-16 19:05:03,613 - INFO - Start polling
2025-03-16 19:05:03,717 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:05:06,029 - INFO - Получение названия группы пользователя.
2025-03-16 19:05:07,012 - INFO - Update id=860671632 is not handled. Duration 986 ms by bot id=7732473607
2025-03-16 19:05:07,013 - ERROR - Cause exception while process update id=860671632 by bot id=7732473607
TypeError: list indices must be integers or slices, not str
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 59, in get_schedules
    await send_schedule_data(callback_query, data)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 31, in send_schedule_data
    for pair in data['subjects']:  # Тут уже список, JSON-декодинг не нужен
TypeError: list indices must be integers or slices, not str
2025-03-16 19:07:57,195 - INFO - Подключение к базе данных установлено.
2025-03-16 19:07:57,532 - INFO - Таблицы проверены/созданы.
2025-03-16 19:07:57,864 - INFO - Индексы проверены/созданы.
2025-03-16 19:07:58,604 - INFO - Для даты 2025-03-22 отсутствует расписание.
2025-03-16 19:07:58,614 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-16 19:07:58,643 - INFO - Для даты 2025-03-21 отсутствует расписание.
2025-03-16 19:07:58,662 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-16 19:07:58,671 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-16 19:07:58,687 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-16 19:08:00,180 - INFO - Добавлено/обновлено 48 записей.
2025-03-16 19:08:00,180 - INFO - Данные расписания сохранены в БД, количество записей: 48.
2025-03-16 19:08:00,585 - INFO - Start polling
2025-03-16 19:08:00,689 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:08:01,851 - INFO - Получение названия группы пользователя.
2025-03-16 19:08:02,843 - INFO - Update id=860671633 is not handled. Duration 994 ms by bot id=7732473607
2025-03-16 19:08:02,843 - ERROR - Cause exception while process update id=860671633 by bot id=7732473607
TypeError: string indices must be integers
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 76, in get_schedules
    await send_schedule_data(callback_query, data)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 42, in send_schedule_data
    pair_data += f"{pair['subject_number']}. {pair['subject_name']} - {pair['room_number']}\n" \
TypeError: string indices must be integers
2025-03-16 19:10:31,631 - INFO - Подключение к базе данных установлено.
2025-03-16 19:10:31,965 - INFO - Таблицы проверены/созданы.
2025-03-16 19:10:32,292 - INFO - Индексы проверены/созданы.
2025-03-16 19:10:32,927 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-16 19:10:32,937 - INFO - Для даты 2025-03-22 отсутствует расписание.
2025-03-16 19:10:32,946 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-16 19:10:32,968 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-16 19:10:32,977 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-16 19:10:32,987 - INFO - Для даты 2025-03-21 отсутствует расписание.
2025-03-16 19:10:34,487 - INFO - Добавлено/обновлено 48 записей.
2025-03-16 19:10:34,487 - INFO - Данные расписания сохранены в БД, количество записей: 48.
2025-03-16 19:10:34,881 - INFO - Start polling
2025-03-16 19:10:34,990 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:10:37,793 - INFO - Получение названия группы пользователя.
2025-03-16 19:10:38,779 - INFO - Update id=860671634 is not handled. Duration 989 ms by bot id=7732473607
2025-03-16 19:10:38,779 - ERROR - Cause exception while process update id=860671634 by bot id=7732473607
TypeError: list indices must be integers or slices, not str
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 76, in get_schedules
    await send_schedule_data(callback_query, data)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 41, in send_schedule_data
    for pair in schedule['subjects']:
TypeError: list indices must be integers or slices, not str
2025-03-16 19:11:09,813 - INFO - Подключение к базе данных установлено.
2025-03-16 19:11:10,137 - INFO - Таблицы проверены/созданы.
2025-03-16 19:11:10,458 - INFO - Индексы проверены/созданы.
2025-03-16 19:11:11,085 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-16 19:11:11,094 - INFO - Для даты 2025-03-22 отсутствует расписание.
2025-03-16 19:11:11,105 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-16 19:11:11,116 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-16 19:11:11,143 - INFO - Для даты 2025-03-21 отсутствует расписание.
2025-03-16 19:11:11,153 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-16 19:11:12,687 - INFO - Добавлено/обновлено 48 записей.
2025-03-16 19:11:12,687 - INFO - Данные расписания сохранены в БД, количество записей: 48.
2025-03-16 19:11:13,084 - INFO - Start polling
2025-03-16 19:11:13,193 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:11:14,541 - INFO - Получение названия группы пользователя.
2025-03-16 19:11:15,509 - INFO - Update id=860671635 is not handled. Duration 970 ms by bot id=7732473607
2025-03-16 19:11:15,509 - ERROR - Cause exception while process update id=860671635 by bot id=7732473607
TypeError: string indices must be integers
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 78, in get_schedules
    await send_schedule_data(callback_query, data)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 44, in send_schedule_data
    pair_data += f"{pair['subject_number']}. {pair['subject_name']} - {pair['room_number']}\n" \
TypeError: string indices must be integers
2025-03-16 19:11:46,356 - INFO - Подключение к базе данных установлено.
2025-03-16 19:11:46,690 - INFO - Таблицы проверены/созданы.
2025-03-16 19:11:47,019 - INFO - Индексы проверены/созданы.
2025-03-16 19:11:48,034 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-16 19:11:48,043 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-16 19:11:48,063 - INFO - Для даты 2025-03-22 отсутствует расписание.
2025-03-16 19:11:48,074 - INFO - Для даты 2025-03-21 отсутствует расписание.
2025-03-16 19:11:48,083 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-16 19:11:48,093 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-16 19:11:49,641 - INFO - Добавлено/обновлено 48 записей.
2025-03-16 19:11:49,641 - INFO - Данные расписания сохранены в БД, количество записей: 48.
2025-03-16 19:11:50,050 - INFO - Start polling
2025-03-16 19:11:50,154 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:11:51,098 - INFO - Получение названия группы пользователя.
2025-03-16 19:11:52,090 - INFO - Update id=860671636 is not handled. Duration 994 ms by bot id=7732473607
2025-03-16 19:11:52,090 - ERROR - Cause exception while process update id=860671636 by bot id=7732473607
TypeError: string indices must be integers
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 79, in get_schedules
    await send_schedule_data(callback_query, data)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 45, in send_schedule_data
    pair_data += f"{pair['subject_number']}. {pair['subject_name']} - {pair['room_number']}\n" \
TypeError: string indices must be integers
2025-03-16 19:25:02,918 - INFO - Подключение к базе данных установлено.
2025-03-16 19:25:03,235 - INFO - Таблицы проверены/созданы.
2025-03-16 19:25:03,546 - INFO - Индексы проверены/созданы.
2025-03-16 19:25:04,260 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-16 19:25:04,270 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-16 19:25:04,308 - INFO - Для даты 2025-03-21 отсутствует расписание.
2025-03-16 19:25:04,321 - INFO - Для даты 2025-03-22 отсутствует расписание.
2025-03-16 19:25:04,330 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-16 19:25:04,340 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-16 19:25:05,809 - INFO - Добавлено/обновлено 48 записей.
2025-03-16 19:25:05,809 - INFO - Данные расписания сохранены в БД, количество записей: 48.
2025-03-16 19:25:06,224 - INFO - Start polling
2025-03-16 19:25:06,333 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:25:09,337 - INFO - Получение названия группы пользователя.
2025-03-16 19:25:10,274 - INFO - Update id=860671637 is not handled. Duration 939 ms by bot id=7732473607
2025-03-16 19:25:10,274 - ERROR - Cause exception while process update id=860671637 by bot id=7732473607
AttributeError: 'datetime.date' object has no attribute 'date'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 61, in get_schedules
    schedule_data = await schedule_manager.get_schedule_by_group(group_name)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/utils/db/schedule_manager.py", line 114, in get_schedule_by_group
    date = record['date'].date()
AttributeError: 'datetime.date' object has no attribute 'date'
2025-03-16 19:28:27,195 - INFO - Подключение к базе данных установлено.
2025-03-16 19:28:27,513 - INFO - Таблицы проверены/созданы.
2025-03-16 19:28:27,828 - INFO - Индексы проверены/созданы.
2025-03-16 19:28:28,578 - INFO - Для даты 2025-03-18 отсутствует расписание.
2025-03-16 19:28:28,588 - INFO - Для даты 2025-03-16 отсутствует расписание.
2025-03-16 19:28:28,620 - INFO - Для даты 2025-03-20 отсутствует расписание.
2025-03-16 19:28:28,636 - INFO - Для даты 2025-03-19 отсутствует расписание.
2025-03-16 19:28:28,646 - INFO - Для даты 2025-03-21 отсутствует расписание.
2025-03-16 19:28:28,656 - INFO - Для даты 2025-03-22 отсутствует расписание.
2025-03-16 19:28:30,070 - INFO - Добавлено/обновлено 48 записей.
2025-03-16 19:28:30,070 - INFO - Данные расписания сохранены в БД, количество записей: 48.
2025-03-16 19:28:30,477 - INFO - Start polling
2025-03-16 19:28:30,586 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:28:36,146 - INFO - Получение названия группы пользователя.
2025-03-16 19:28:37,096 - INFO - Update id=860671638 is handled. Duration 952 ms by bot id=7732473607
2025-03-16 19:29:21,983 - INFO - Подключение к базе данных установлено.
2025-03-16 19:29:22,307 - INFO - Таблицы проверены/созданы.
2025-03-16 19:29:22,626 - INFO - Индексы проверены/созданы.
2025-03-16 19:29:23,026 - INFO - Start polling
2025-03-16 19:29:23,133 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-16 19:29:23,993 - INFO - Получение названия группы пользователя.
2025-03-16 19:29:24,955 - INFO - Update id=860671639 is handled. Duration 965 ms by bot id=7732473607
2025-03-17 19:53:03,023 - INFO - Подключение к базе данных установлено.
2025-03-17 19:53:03,518 - INFO - Таблицы проверены/созданы.
2025-03-17 19:53:04,123 - INFO - Индексы проверены/созданы.
2025-03-17 19:53:04,891 - INFO - Для даты 2025-03-23 отсутствует расписание.
2025-03-17 19:53:16,322 - INFO - Добавлено/обновлено 288 записей.
2025-03-17 19:53:16,323 - INFO - Данные расписания сохранены в БД, количество записей: 288.
2025-03-17 19:53:16,722 - INFO - Start polling
2025-03-17 19:53:16,824 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:18:26,562 - INFO - Подключение к базе данных установлено.
2025-03-17 20:18:26,862 - INFO - Таблицы проверены/созданы.
2025-03-17 20:18:27,158 - INFO - Индексы проверены/созданы.
2025-03-17 20:18:27,639 - INFO - Start polling
2025-03-17 20:18:27,736 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:19:01,183 - INFO - Update id=860671640 is handled. Duration 824 ms by bot id=7732473607
2025-03-17 20:19:02,342 - INFO - Получение названия группы пользователя.
2025-03-17 20:19:03,227 - INFO - Update id=860671641 is not handled. Duration 887 ms by bot id=7732473607
2025-03-17 20:19:03,227 - ERROR - Cause exception while process update id=860671641 by bot id=7732473607
TypeError: send_schedule_data() missing 1 required positional argument: 'schedule_data'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 67, in get_schedules
    await send_schedule_data(callback_query, schedule_data)
TypeError: send_schedule_data() missing 1 required positional argument: 'schedule_data'
2025-03-17 20:34:42,211 - INFO - Подключение к базе данных установлено.
2025-03-17 20:34:42,520 - INFO - Таблицы проверены/созданы.
2025-03-17 20:34:42,825 - INFO - Индексы проверены/созданы.
2025-03-17 20:34:43,191 - INFO - Start polling
2025-03-17 20:34:43,287 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:34:46,026 - INFO - Получение названия группы пользователя.
2025-03-17 20:34:46,942 - INFO - Update id=860671642 is not handled. Duration 918 ms by bot id=7732473607
2025-03-17 20:34:46,942 - ERROR - Cause exception while process update id=860671642 by bot id=7732473607
TypeError: list indices must be integers or slices, not str
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 98, in get_schedules
    await send_schedule_data(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 36, in send_schedule_data
    for pair in schedule_data['subjects']:
TypeError: list indices must be integers or slices, not str
2025-03-17 20:35:39,715 - INFO - Подключение к базе данных установлено.
2025-03-17 20:35:40,022 - INFO - Таблицы проверены/созданы.
2025-03-17 20:35:40,326 - INFO - Индексы проверены/созданы.
2025-03-17 20:35:40,697 - INFO - Start polling
2025-03-17 20:35:40,795 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:35:41,592 - INFO - Получение названия группы пользователя.
2025-03-17 20:35:42,501 - INFO - Update id=860671643 is not handled. Duration 910 ms by bot id=7732473607
2025-03-17 20:35:42,501 - ERROR - Cause exception while process update id=860671643 by bot id=7732473607
TypeError: send_schedule_data() got an unexpected keyword argument 'schedule_manager'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 99, in get_schedules
    await send_schedule_data(
TypeError: send_schedule_data() got an unexpected keyword argument 'schedule_manager'
2025-03-17 20:36:23,152 - INFO - Подключение к базе данных установлено.
2025-03-17 20:36:23,459 - INFO - Таблицы проверены/созданы.
2025-03-17 20:36:23,762 - INFO - Индексы проверены/созданы.
2025-03-17 20:36:24,129 - INFO - Start polling
2025-03-17 20:36:24,223 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:36:25,057 - INFO - Получение названия группы пользователя.
2025-03-17 20:36:25,959 - INFO - Update id=860671644 is not handled. Duration 904 ms by bot id=7732473607
2025-03-17 20:36:25,960 - ERROR - Cause exception while process update id=860671644 by bot id=7732473607
TypeError: list indices must be integers or slices, not str
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 99, in get_schedules
    await send_schedule_data(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 37, in send_schedule_data
    for pair in schedule_data['subjects']:
TypeError: list indices must be integers or slices, not str
2025-03-17 20:36:57,370 - INFO - Подключение к базе данных установлено.
2025-03-17 20:36:57,696 - INFO - Таблицы проверены/созданы.
2025-03-17 20:36:58,019 - INFO - Индексы проверены/созданы.
2025-03-17 20:36:58,391 - INFO - Start polling
2025-03-17 20:36:58,486 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:37:00,587 - INFO - Получение названия группы пользователя.
2025-03-17 20:37:01,559 - INFO - Update id=860671645 is not handled. Duration 974 ms by bot id=7732473607
2025-03-17 20:37:01,559 - ERROR - Cause exception while process update id=860671645 by bot id=7732473607
TypeError: string indices must be integers
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 99, in get_schedules
    await send_schedule_data(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 38, in send_schedule_data
    pair_data += f"{pair['subject_number']}. {pair['subject_name']} - {pair['room_number']}\n" \
TypeError: string indices must be integers
2025-03-17 20:39:28,447 - INFO - Подключение к базе данных установлено.
2025-03-17 20:39:28,758 - INFO - Таблицы проверены/созданы.
2025-03-17 20:39:29,062 - INFO - Индексы проверены/созданы.
2025-03-17 20:39:29,433 - INFO - Start polling
2025-03-17 20:39:29,530 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:39:32,197 - INFO - Update id=860671646 is handled. Duration 773 ms by bot id=7732473607
2025-03-17 20:39:33,025 - INFO - Получение названия группы пользователя.
2025-03-17 20:39:33,942 - INFO - Update id=860671647 is not handled. Duration 918 ms by bot id=7732473607
2025-03-17 20:39:33,942 - ERROR - Cause exception while process update id=860671647 by bot id=7732473607
TypeError: string indices must be integers
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 99, in get_schedules
    await send_schedule_data(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 38, in send_schedule_data
    pair_data += f"{pair['subject_number']}. {pair['subject_name']} - {pair['room_number']}\n" \
TypeError: string indices must be integers
2025-03-17 20:40:40,275 - INFO - Подключение к базе данных установлено.
2025-03-17 20:40:40,573 - INFO - Таблицы проверены/созданы.
2025-03-17 20:40:40,865 - INFO - Индексы проверены/созданы.
2025-03-17 20:40:41,231 - INFO - Start polling
2025-03-17 20:40:41,329 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:40:42,470 - INFO - Получение названия группы пользователя.
2025-03-17 20:40:43,730 - INFO - Update id=860671648 is handled. Duration 1262 ms by bot id=7732473607
2025-03-17 20:41:19,936 - INFO - Подключение к базе данных установлено.
2025-03-17 20:41:20,244 - INFO - Таблицы проверены/созданы.
2025-03-17 20:41:20,551 - INFO - Индексы проверены/созданы.
2025-03-17 20:41:20,920 - INFO - Start polling
2025-03-17 20:41:21,017 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:41:23,503 - INFO - Update id=860671649 is handled. Duration 847 ms by bot id=7732473607
2025-03-17 20:41:24,729 - INFO - Получение названия группы пользователя.
2025-03-17 20:41:25,757 - INFO - Update id=860671650 is handled. Duration 1031 ms by bot id=7732473607
2025-03-17 20:41:29,550 - INFO - Update id=860671651 is not handled. Duration 457 ms by bot id=7732473607
2025-03-17 20:41:29,550 - ERROR - Cause exception while process update id=860671651 by bot id=7732473607
ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<Record date=datetime.date(2025, 3, 17)>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 78, in schedule_edit_date
    reply_markup=inline_builder(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 28, in inline_builder
    [
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 29, in <listcomp>
    builder.button(text=txt, callback_data=cb)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 323, in button
    self._button(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 256, in _button
    button = self._button_type(**kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<Record date=datetime.date(2025, 3, 17)>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-17 20:43:29,499 - INFO - Подключение к базе данных установлено.
2025-03-17 20:43:29,812 - INFO - Таблицы проверены/созданы.
2025-03-17 20:43:30,120 - INFO - Индексы проверены/созданы.
2025-03-17 20:43:30,488 - INFO - Start polling
2025-03-17 20:43:30,584 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:43:33,328 - INFO - Update id=860671652 is not handled. Duration 463 ms by bot id=7732473607
2025-03-17 20:43:33,328 - ERROR - Cause exception while process update id=860671652 by bot id=7732473607
ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<Record date=datetime.date(2025, 3, 17)>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 79, in schedule_edit_date
    reply_markup=inline_builder(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 28, in inline_builder
    [
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 29, in <listcomp>
    builder.button(text=txt, callback_data=cb)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 323, in button
    self._button(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 256, in _button
    button = self._button_type(**kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<Record date=datetime.date(2025, 3, 17)>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-17 20:43:54,666 - INFO - Подключение к базе данных установлено.
2025-03-17 20:43:54,968 - INFO - Таблицы проверены/созданы.
2025-03-17 20:43:55,264 - INFO - Индексы проверены/созданы.
2025-03-17 20:43:55,635 - INFO - Start polling
2025-03-17 20:43:55,731 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:43:56,977 - INFO - Update id=860671653 is not handled. Duration 461 ms by bot id=7732473607
2025-03-17 20:43:56,977 - ERROR - Cause exception while process update id=860671653 by bot id=7732473607
TypeError: 'datetime.date' object is not iterable
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 74, in schedule_edit_date
    buttons = [(date, f'schedules|{date}') for date in date_list]
TypeError: 'datetime.date' object is not iterable
2025-03-17 20:44:13,129 - INFO - Подключение к базе данных установлено.
2025-03-17 20:44:13,436 - INFO - Таблицы проверены/созданы.
2025-03-17 20:44:13,739 - INFO - Индексы проверены/созданы.
2025-03-17 20:44:14,104 - INFO - Start polling
2025-03-17 20:44:14,226 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:44:15,795 - INFO - Update id=860671654 is not handled. Duration 455 ms by bot id=7732473607
2025-03-17 20:44:15,795 - ERROR - Cause exception while process update id=860671654 by bot id=7732473607
ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=datetime.date(2025, 3, 17), input_type=date]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 79, in schedule_edit_date
    reply_markup=inline_builder(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 28, in inline_builder
    [
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 29, in <listcomp>
    builder.button(text=txt, callback_data=cb)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 323, in button
    self._button(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 256, in _button
    button = self._button_type(**kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=datetime.date(2025, 3, 17), input_type=date]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-17 20:44:45,246 - INFO - Подключение к базе данных установлено.
2025-03-17 20:44:45,581 - INFO - Таблицы проверены/созданы.
2025-03-17 20:44:45,915 - INFO - Индексы проверены/созданы.
2025-03-17 20:44:46,301 - INFO - Start polling
2025-03-17 20:44:46,398 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:44:47,976 - INFO - Update id=860671655 is not handled. Duration 499 ms by bot id=7732473607
2025-03-17 20:44:47,976 - ERROR - Cause exception while process update id=860671655 by bot id=7732473607
ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<Record date=datetime.date(2025, 3, 17)>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 78, in schedule_edit_date
    reply_markup=inline_builder(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 28, in inline_builder
    [
  File "/home/john/Documents/code/python/aiogram_pmk_bot/keyboards/builders.py", line 29, in <listcomp>
    builder.button(text=txt, callback_data=cb)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 323, in button
    self._button(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/utils/keyboard.py", line 256, in _button
    button = self._button_type(**kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<Record date=datetime.date(2025, 3, 17)>, input_type=Record]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-17 20:46:10,875 - INFO - Подключение к базе данных установлено.
2025-03-17 20:46:11,181 - INFO - Таблицы проверены/созданы.
2025-03-17 20:46:11,485 - INFO - Индексы проверены/созданы.
2025-03-17 20:46:11,858 - INFO - Start polling
2025-03-17 20:46:12,000 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:46:15,950 - INFO - Update id=860671656 is not handled. Duration 456 ms by bot id=7732473607
2025-03-17 20:46:15,950 - ERROR - Cause exception while process update id=860671656 by bot id=7732473607
AttributeError: 'asyncpg.Record' object has no attribute 'strftime'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 73, in schedule_edit_date
    buttons = [(date.strftime('%Y-%m-%d'), f'schedules|{date.strftime("%Y-%m-%d")}') for date in date_list]
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 73, in <listcomp>
    buttons = [(date.strftime('%Y-%m-%d'), f'schedules|{date.strftime("%Y-%m-%d")}') for date in date_list]
AttributeError: 'asyncpg.Record' object has no attribute 'strftime'
2025-03-17 20:46:55,501 - INFO - Подключение к базе данных установлено.
2025-03-17 20:46:55,797 - INFO - Таблицы проверены/созданы.
2025-03-17 20:46:56,091 - INFO - Индексы проверены/созданы.
2025-03-17 20:46:56,459 - INFO - Start polling
2025-03-17 20:46:56,555 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:46:58,110 - INFO - Update id=860671657 is handled. Duration 765 ms by bot id=7732473607
2025-03-17 20:47:04,926 - INFO - Получение названия группы пользователя.
2025-03-17 20:47:05,661 - INFO - Update id=860671658 is not handled. Duration 737 ms by bot id=7732473607
2025-03-17 20:47:05,661 - ERROR - Cause exception while process update id=860671658 by bot id=7732473607
DataError: invalid input for query argument $2: '2025-03-18' ('str' object has no attribute 'toordinal')
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 97, in asyncpg.pgproto.pgproto.date_encode
AttributeError: 'str' object has no attribute 'toordinal'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 99, in get_schedules
    schedule_data = await schedule_manager.get_schedule_by_group(group_name, date)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/utils/db/schedule_manager.py", line 85, in get_schedule_by_group
    return await self.pool.fetchrow(query, group_name, date)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/pool.py", line 628, in fetchrow
    return await con.fetchrow(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 748, in fetchrow
    data = await self._execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $2: '2025-03-18' ('str' object has no attribute 'toordinal')
2025-03-17 20:48:21,741 - INFO - Подключение к базе данных установлено.
2025-03-17 20:48:22,058 - INFO - Таблицы проверены/созданы.
2025-03-17 20:48:22,368 - INFO - Индексы проверены/созданы.
2025-03-17 20:48:22,734 - INFO - Start polling
2025-03-17 20:48:22,834 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:48:31,185 - INFO - Получение названия группы пользователя.
2025-03-17 20:48:32,434 - INFO - Update id=860671659 is handled. Duration 1260 ms by bot id=7732473607
2025-03-17 20:48:35,474 - INFO - Update id=860671660 is handled. Duration 582 ms by bot id=7732473607
2025-03-17 20:48:36,323 - INFO - Получение названия группы пользователя.
2025-03-17 20:48:37,069 - INFO - Update id=860671661 is handled. Duration 749 ms by bot id=7732473607
2025-03-17 20:48:38,435 - INFO - Update id=860671662 is handled. Duration 425 ms by bot id=7732473607
2025-03-17 20:48:39,012 - INFO - Получение названия группы пользователя.
2025-03-17 20:48:39,822 - INFO - Update id=860671663 is handled. Duration 812 ms by bot id=7732473607
2025-03-17 20:48:42,947 - INFO - Update id=860671664 is handled. Duration 478 ms by bot id=7732473607
2025-03-17 20:48:43,557 - INFO - Получение названия группы пользователя.
2025-03-17 20:48:44,367 - INFO - Update id=860671665 is handled. Duration 813 ms by bot id=7732473607
2025-03-17 20:49:32,553 - INFO - Update id=860671666 is handled. Duration 533 ms by bot id=7732473607
2025-03-17 20:49:37,940 - INFO - Получение названия группы пользователя.
2025-03-17 20:49:38,682 - INFO - Update id=860671667 is handled. Duration 744 ms by bot id=7732473607
2025-03-17 20:59:04,167 - INFO - Подключение к базе данных установлено.
2025-03-17 20:59:04,474 - INFO - Таблицы проверены/созданы.
2025-03-17 20:59:04,778 - INFO - Индексы проверены/созданы.
2025-03-17 20:59:05,162 - INFO - Start polling
2025-03-17 20:59:05,262 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 20:59:07,670 - INFO - Update id=860671668 is handled. Duration 826 ms by bot id=7732473607
2025-03-17 20:59:09,265 - INFO - Получение названия группы пользователя.
2025-03-17 20:59:10,317 - INFO - Update id=860671669 is handled. Duration 1054 ms by bot id=7732473607
2025-03-17 20:59:12,067 - INFO - Update id=860671670 is handled. Duration 438 ms by bot id=7732473607
2025-03-17 20:59:12,815 - INFO - Update id=860671671 is not handled. Duration 1 ms by bot id=7732473607
2025-03-17 20:59:12,815 - ERROR - Cause exception while process update id=860671671 by bot id=7732473607
TypeError: send_profile() missing 1 required positional argument: 'admin_manager'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/profile.py", line 115, in profile
    await send_profile(callback_query.from_user.id, user_service, callback_query=callback_query)
TypeError: send_profile() missing 1 required positional argument: 'admin_manager'
2025-03-17 21:01:48,016 - INFO - Подключение к базе данных установлено.
2025-03-17 21:01:48,351 - INFO - Таблицы проверены/созданы.
2025-03-17 21:01:48,682 - INFO - Индексы проверены/созданы.
2025-03-17 21:01:49,053 - INFO - Start polling
2025-03-17 21:01:49,150 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:01:50,834 - INFO - Update id=860671672 is not handled. Duration 1 ms by bot id=7732473607
2025-03-17 21:01:50,834 - ERROR - Cause exception while process update id=860671672 by bot id=7732473607
TypeError: send_profile() missing 1 required positional argument: 'admin_manager'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/profile.py", line 94, in profile
    await send_profile(callback_query.from_user.id, user_service, callback_query=callback_query)
TypeError: send_profile() missing 1 required positional argument: 'admin_manager'
2025-03-17 21:02:56,560 - INFO - Подключение к базе данных установлено.
2025-03-17 21:02:56,860 - INFO - Таблицы проверены/созданы.
2025-03-17 21:02:57,158 - INFO - Индексы проверены/созданы.
2025-03-17 21:02:57,524 - INFO - Start polling
2025-03-17 21:02:57,622 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:02:58,422 - ERROR - Ошибка при получении информации пользователя: 'UserService' object has no attribute 'get_user_info'
2025-03-17 21:02:58,751 - INFO - Update id=860671673 is handled. Duration 330 ms by bot id=7732473607
2025-03-17 21:05:39,985 - INFO - Подключение к базе данных установлено.
2025-03-17 21:05:40,299 - INFO - Таблицы проверены/созданы.
2025-03-17 21:05:40,608 - INFO - Индексы проверены/созданы.
2025-03-17 21:05:40,980 - INFO - Start polling
2025-03-17 21:05:41,078 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:05:42,802 - INFO - Update id=860671674 is not handled. Duration 466 ms by bot id=7732473607
2025-03-17 21:05:42,802 - ERROR - Cause exception while process update id=860671674 by bot id=7732473607
AttributeError: 'list' object has no attribute 'get'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/profile.py", line 94, in profile
    await send_profile(callback_query.from_user.id, user_service, admin_manager, callback_query=callback_query)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/profile.py", line 43, in send_profile
    date_str = data.get("datetime_reg", "неизвестно").strftime('%d.%m.%Y') if isinstance(data.get("datetime_reg"), datetime) else "неизвестно"
AttributeError: 'list' object has no attribute 'get'
2025-03-17 21:06:23,306 - INFO - Подключение к базе данных установлено.
2025-03-17 21:06:23,634 - INFO - Таблицы проверены/созданы.
2025-03-17 21:06:23,959 - INFO - Индексы проверены/созданы.
2025-03-17 21:06:24,404 - INFO - Start polling
2025-03-17 21:06:24,502 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:06:26,399 - INFO - Update id=860671675 is handled. Duration 833 ms by bot id=7732473607
2025-03-17 21:06:56,771 - ERROR - Ошибка при получении списка групп: 'UserService' object has no attribute 'get_group_name'
2025-03-17 21:06:56,895 - INFO - Update id=860671676 is handled. Duration 125 ms by bot id=7732473607
2025-03-17 21:09:11,071 - INFO - Подключение к базе данных установлено.
2025-03-17 21:09:11,398 - INFO - Таблицы проверены/созданы.
2025-03-17 21:09:11,718 - INFO - Индексы проверены/созданы.
2025-03-17 21:09:12,086 - INFO - Start polling
2025-03-17 21:09:12,185 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:09:13,955 - INFO - Получение названий групп из расписания.
2025-03-17 21:09:14,775 - INFO - Update id=860671677 is handled. Duration 822 ms by bot id=7732473607
2025-03-17 21:09:18,781 - INFO - Изменена группа пользователя 5124967932 на КСК-2024-1/3.
2025-03-17 21:09:18,782 - INFO - Update id=860671678 is not handled. Duration 534 ms by bot id=7732473607
2025-03-17 21:09:18,782 - ERROR - Cause exception while process update id=860671678 by bot id=7732473607
TypeError: send_profile() missing 1 required positional argument: 'admin_manager'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/profile.py", line 185, in get_group_name
    await send_profile(user_id, user_service, callback_query=callback_query)
TypeError: send_profile() missing 1 required positional argument: 'admin_manager'
2025-03-17 21:11:15,420 - INFO - Подключение к базе данных установлено.
2025-03-17 21:11:15,740 - INFO - Таблицы проверены/созданы.
2025-03-17 21:11:16,057 - INFO - Индексы проверены/созданы.
2025-03-17 21:11:16,431 - INFO - Start polling
2025-03-17 21:11:16,528 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:11:20,599 - INFO - Update id=860671679 is handled. Duration 1074 ms by bot id=7732473607
2025-03-17 21:11:23,291 - INFO - Update id=860671680 is handled. Duration 596 ms by bot id=7732473607
2025-03-17 21:11:24,645 - INFO - Получение названий групп из расписания.
2025-03-17 21:11:25,284 - INFO - Update id=860671681 is handled. Duration 640 ms by bot id=7732473607
2025-03-17 21:11:27,028 - INFO - Изменена группа пользователя 5124967932 на КСК-2024-1/3.
2025-03-17 21:11:27,465 - INFO - Update id=860671682 is handled. Duration 965 ms by bot id=7732473607
2025-03-17 21:12:14,607 - INFO - Подключение к базе данных установлено.
2025-03-17 21:12:14,901 - INFO - Таблицы проверены/созданы.
2025-03-17 21:12:15,194 - INFO - Индексы проверены/созданы.
2025-03-17 21:12:15,585 - INFO - Start polling
2025-03-17 21:12:15,688 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:12:17,214 - INFO - Update id=860671683 is handled. Duration 752 ms by bot id=7732473607
2025-03-17 21:12:18,318 - INFO - Получение названия группы пользователя.
2025-03-17 21:12:19,340 - INFO - Update id=860671684 is handled. Duration 1024 ms by bot id=7732473607
2025-03-17 21:12:27,802 - INFO - Update id=860671685 is handled. Duration 578 ms by bot id=7732473607
2025-03-17 21:12:29,044 - INFO - Получение названия группы пользователя.
2025-03-17 21:12:29,818 - INFO - Update id=860671686 is handled. Duration 776 ms by bot id=7732473607
2025-03-17 21:12:32,601 - INFO - Update id=860671687 is handled. Duration 463 ms by bot id=7732473607
2025-03-17 21:12:35,425 - INFO - Получение названия группы пользователя.
2025-03-17 21:12:36,139 - INFO - Update id=860671688 is handled. Duration 716 ms by bot id=7732473607
2025-03-17 21:12:42,770 - INFO - Update id=860671689 is handled. Duration 435 ms by bot id=7732473607
2025-03-17 21:12:44,509 - INFO - Update id=860671690 is handled. Duration 561 ms by bot id=7732473607
2025-03-17 21:12:45,707 - INFO - Получение названий групп из расписания.
2025-03-17 21:12:46,283 - INFO - Update id=860671691 is handled. Duration 578 ms by bot id=7732473607
2025-03-17 21:12:48,714 - INFO - Изменена группа пользователя 5124967932 на ССА-2022-2.
2025-03-17 21:12:49,173 - INFO - Update id=860671692 is handled. Duration 943 ms by bot id=7732473607
2025-03-17 21:12:57,000 - INFO - Update id=860671693 is handled. Duration 456 ms by bot id=7732473607
2025-03-17 21:12:57,953 - INFO - Получение названия группы пользователя.
2025-03-17 21:12:58,673 - INFO - Update id=860671694 is handled. Duration 723 ms by bot id=7732473607
2025-03-17 21:13:03,020 - INFO - Update id=860671695 is handled. Duration 481 ms by bot id=7732473607
2025-03-17 21:13:05,046 - INFO - Получение названия группы пользователя.
2025-03-17 21:13:05,758 - INFO - Update id=860671696 is handled. Duration 715 ms by bot id=7732473607
2025-03-17 21:13:08,678 - INFO - Update id=860671697 is handled. Duration 404 ms by bot id=7732473607
2025-03-17 21:14:28,952 - INFO - Подключение к базе данных установлено.
2025-03-17 21:14:29,259 - INFO - Таблицы проверены/созданы.
2025-03-17 21:14:29,563 - INFO - Индексы проверены/созданы.
2025-03-17 21:14:29,928 - INFO - Start polling
2025-03-17 21:14:30,023 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:14:33,325 - INFO - Получение названия группы пользователя.
2025-03-17 21:14:34,553 - INFO - Update id=860671698 is handled. Duration 1230 ms by bot id=7732473607
2025-03-17 21:14:38,114 - INFO - Update id=860671699 is handled. Duration 592 ms by bot id=7732473607
2025-03-17 21:14:49,272 - INFO - Update id=860671700 is handled. Duration 607 ms by bot id=7732473607
2025-03-17 21:15:00,522 - INFO - Подключение к базе данных установлено.
2025-03-17 21:15:00,834 - INFO - Таблицы проверены/созданы.
2025-03-17 21:15:01,139 - INFO - Индексы проверены/созданы.
2025-03-17 21:15:01,506 - INFO - Start polling
2025-03-17 21:15:01,602 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:15:02,362 - INFO - Получение названия группы пользователя.
2025-03-17 21:15:03,601 - INFO - Update id=860671701 is handled. Duration 1241 ms by bot id=7732473607
2025-03-17 21:15:05,263 - INFO - Update id=860671702 is handled. Duration 626 ms by bot id=7732473607
2025-03-17 21:15:49,533 - INFO - Получение названия группы пользователя.
2025-03-17 21:15:50,328 - INFO - Update id=860671703 is handled. Duration 798 ms by bot id=7732473607
2025-03-17 21:17:01,430 - INFO - Update id=860671704 is not handled. Duration 2 ms by bot id=7732473607
2025-03-17 21:17:03,980 - INFO - Update id=860671705 is handled. Duration 425 ms by bot id=7732473607
2025-03-17 21:17:06,269 - INFO - Получение названия группы пользователя.
2025-03-17 21:17:07,080 - INFO - Update id=860671706 is handled. Duration 814 ms by bot id=7732473607
2025-03-17 21:18:13,891 - INFO - Update id=860671707 is handled. Duration 493 ms by bot id=7732473607
2025-03-17 21:18:16,197 - INFO - Получение названия группы пользователя.
2025-03-17 21:18:17,008 - INFO - Update id=860671708 is handled. Duration 813 ms by bot id=7732473607
2025-03-17 21:18:38,448 - INFO - Update id=860671709 is handled. Duration 433 ms by bot id=7732473607
2025-03-17 21:18:40,178 - INFO - Получение названия группы пользователя.
2025-03-17 21:18:40,929 - INFO - Update id=860671710 is handled. Duration 753 ms by bot id=7732473607
2025-03-17 21:19:03,170 - INFO - Update id=860671711 is handled. Duration 432 ms by bot id=7732473607
2025-03-17 21:20:37,568 - INFO - Подключение к базе данных установлено.
2025-03-17 21:20:37,870 - INFO - Таблицы проверены/созданы.
2025-03-17 21:20:38,169 - INFO - Индексы проверены/созданы.
2025-03-17 21:20:38,535 - INFO - Start polling
2025-03-17 21:20:38,632 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:20:40,952 - INFO - Update id=860671712 is handled. Duration 763 ms by bot id=7732473607
2025-03-17 21:20:42,294 - INFO - Получение названия группы пользователя.
2025-03-17 21:20:43,315 - INFO - Update id=860671713 is handled. Duration 1023 ms by bot id=7732473607
2025-03-17 21:20:46,638 - INFO - Update id=860671714 is handled. Duration 571 ms by bot id=7732473607
2025-03-17 21:20:59,967 - WARNING - Received SIGINT signal
2025-03-17 21:20:59,968 - INFO - Polling stopped for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:20:59,968 - INFO - Polling stopped
2025-03-17 21:21:00,387 - INFO - Подключение к базе данных закрыто.
2025-03-17 21:21:54,778 - INFO - Подключение к базе данных установлено.
2025-03-17 21:21:55,088 - INFO - Таблицы проверены/созданы.
2025-03-17 21:21:55,396 - INFO - Индексы проверены/созданы.
2025-03-17 21:21:55,777 - INFO - Start polling
2025-03-17 21:21:55,881 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:21:57,700 - INFO - Update id=860671715 is handled. Duration 835 ms by bot id=7732473607
2025-03-17 21:21:58,751 - INFO - Получение названия группы пользователя.
2025-03-17 21:21:59,792 - INFO - Update id=860671716 is handled. Duration 1043 ms by bot id=7732473607
2025-03-17 21:22:30,856 - INFO - Update id=860671717 is handled. Duration 657 ms by bot id=7732473607
2025-03-17 21:22:35,976 - INFO - Получение названия группы пользователя.
2025-03-17 21:22:36,705 - INFO - Update id=860671718 is handled. Duration 732 ms by bot id=7732473607
2025-03-17 21:22:38,306 - INFO - Update id=860671719 is handled. Duration 424 ms by bot id=7732473607
2025-03-17 21:22:40,613 - INFO - Получение названия группы пользователя.
2025-03-17 21:22:41,343 - INFO - Update id=860671720 is handled. Duration 731 ms by bot id=7732473607
2025-03-17 21:22:44,549 - INFO - Update id=860671721 is handled. Duration 457 ms by bot id=7732473607
2025-03-17 21:23:01,510 - INFO - Получение названия группы пользователя.
2025-03-17 21:23:02,240 - INFO - Update id=860671722 is handled. Duration 733 ms by bot id=7732473607
2025-03-17 21:23:46,560 - INFO - Подключение к базе данных установлено.
2025-03-17 21:23:46,867 - INFO - Таблицы проверены/созданы.
2025-03-17 21:23:47,166 - INFO - Индексы проверены/созданы.
2025-03-17 21:23:47,539 - INFO - Start polling
2025-03-17 21:23:47,636 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:23:50,584 - INFO - Update id=860671723 is handled. Duration 808 ms by bot id=7732473607
2025-03-17 21:23:51,930 - INFO - Получение названия группы пользователя.
2025-03-17 21:23:53,026 - INFO - Update id=860671724 is handled. Duration 1099 ms by bot id=7732473607
2025-03-17 21:23:58,752 - INFO - Update id=860671725 is handled. Duration 553 ms by bot id=7732473607
2025-03-17 21:24:01,191 - INFO - Получение названия группы пользователя.
2025-03-17 21:24:01,910 - INFO - Update id=860671726 is handled. Duration 721 ms by bot id=7732473607
2025-03-17 21:24:07,523 - INFO - Update id=860671727 is handled. Duration 429 ms by bot id=7732473607
2025-03-17 21:24:14,103 - INFO - Получение названия группы пользователя.
2025-03-17 21:24:14,859 - INFO - Update id=860671728 is handled. Duration 759 ms by bot id=7732473607
2025-03-17 21:24:23,197 - INFO - Update id=860671729 is handled. Duration 431 ms by bot id=7732473607
2025-03-17 21:26:34,554 - INFO - Подключение к базе данных установлено.
2025-03-17 21:26:34,863 - INFO - Таблицы проверены/созданы.
2025-03-17 21:26:35,166 - INFO - Индексы проверены/созданы.
2025-03-17 21:26:35,536 - INFO - Start polling
2025-03-17 21:26:35,645 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:26:37,014 - INFO - Получение названия группы пользователя.
2025-03-17 21:26:38,300 - INFO - Update id=860671730 is handled. Duration 1291 ms by bot id=7732473607
2025-03-17 21:26:42,680 - INFO - Update id=860671731 is handled. Duration 719 ms by bot id=7732473607
2025-03-17 21:26:43,725 - INFO - Получение названия группы пользователя.
2025-03-17 21:26:44,479 - INFO - Update id=860671732 is handled. Duration 756 ms by bot id=7732473607
2025-03-17 21:26:46,843 - INFO - Update id=860671733 is handled. Duration 430 ms by bot id=7732473607
2025-03-17 21:26:47,664 - INFO - Получение названия группы пользователя.
2025-03-17 21:26:48,406 - INFO - Update id=860671734 is handled. Duration 744 ms by bot id=7732473607
2025-03-17 21:26:52,111 - INFO - Update id=860671735 is handled. Duration 425 ms by bot id=7732473607
2025-03-17 21:26:53,187 - INFO - Получение названия группы пользователя.
2025-03-17 21:26:53,936 - INFO - Update id=860671736 is handled. Duration 751 ms by bot id=7732473607
2025-03-17 21:30:09,566 - INFO - Подключение к базе данных установлено.
2025-03-17 21:30:09,877 - INFO - Таблицы проверены/созданы.
2025-03-17 21:30:10,185 - INFO - Индексы проверены/созданы.
2025-03-17 21:30:10,553 - INFO - Start polling
2025-03-17 21:30:10,660 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 21:30:12,896 - INFO - Update id=860671737 is handled. Duration 773 ms by bot id=7732473607
2025-03-17 21:30:15,241 - INFO - Количество незакрытых сообщений поддержки: 0
2025-03-17 21:30:15,459 - INFO - Update id=860671738 is handled. Duration 1131 ms by bot id=7732473607
2025-03-17 21:31:06,358 - INFO - Update id=860671739 is handled. Duration 116 ms by bot id=7732473607
2025-03-17 21:31:13,988 - INFO - Операция пополнения для 5124967932 с id 1 создана.
2025-03-17 21:31:14,171 - INFO - Update id=860671740 is not handled. Duration 677 ms by bot id=7732473607
2025-03-17 21:31:14,171 - ERROR - Cause exception while process update id=860671740 by bot id=7732473607
TelegramBadRequest: Telegram server says - Bad Request: PAYMENT_PROVIDER_INVALID
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/middlewares/album.py", line 21, in __call__
    await handler(message, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/payment.py", line 65, in message_payment
    await send_payment(bot, user_amount, chat_id, user_id, payment_service)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/payment.py", line 23, in send_payment
    await bot.send_invoice(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/bot.py", line 2781, in send_invoice
    return await self(call, request_timeout=request_timeout)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/bot.py", line 498, in __call__
    return await self.session(self, method, timeout=request_timeout)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/aiohttp.py", line 185, in make_request
    response = self.check_response(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: PAYMENT_PROVIDER_INVALID
2025-03-17 21:31:20,879 - INFO - Update id=860671741 is handled. Duration 460 ms by bot id=7732473607
2025-03-17 21:31:25,682 - INFO - Update id=860671742 is handled. Duration 120 ms by bot id=7732473607
2025-03-17 21:31:37,559 - INFO - Update id=860671743 is handled. Duration 189 ms by bot id=7732473607
2025-03-17 21:31:47,257 - INFO - Update id=860671744 is handled. Duration 136 ms by bot id=7732473607
2025-03-17 21:31:57,086 - INFO - Update id=860671745 is handled. Duration 147 ms by bot id=7732473607
2025-03-17 21:32:07,098 - INFO - Update id=860671746 is handled. Duration 132 ms by bot id=7732473607
2025-03-17 21:32:21,926 - INFO - Update id=860671747 is handled. Duration 169 ms by bot id=7732473607
2025-03-17 21:32:23,617 - INFO - Update id=860671748 is handled. Duration 116 ms by bot id=7732473607
2025-03-17 21:32:53,262 - INFO - Update id=860671749 is handled. Duration 155 ms by bot id=7732473607
2025-03-17 21:33:50,179 - INFO - Update id=860671750 is not handled. Duration 1 ms by bot id=7732473607
2025-03-17 21:33:50,179 - ERROR - Cause exception while process update id=860671750 by bot id=7732473607
AttributeError: 'UserService' object has no attribute 'get_balance'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/new_order.py", line 181, in order_completed
    balance = await user_service.get_balance(user_id)
AttributeError: 'UserService' object has no attribute 'get_balance'
2025-03-17 22:13:26,543 - INFO - Подключение к базе данных установлено.
2025-03-17 22:13:26,865 - INFO - Таблицы проверены/созданы.
2025-03-17 22:13:27,175 - INFO - Индексы проверены/созданы.
2025-03-17 22:13:27,545 - INFO - Start polling
2025-03-17 22:13:27,641 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:13:41,648 - INFO - Update id=860671751 is handled. Duration 799 ms by bot id=7732473607
2025-03-17 22:13:45,142 - INFO - Получение названия группы пользователя.
2025-03-17 22:13:46,205 - INFO - Update id=860671752 is handled. Duration 1066 ms by bot id=7732473607
2025-03-17 22:13:51,477 - INFO - Update id=860671753 is handled. Duration 694 ms by bot id=7732473607
2025-03-17 22:14:02,628 - INFO - Получение названия группы пользователя.
2025-03-17 22:14:03,388 - INFO - Update id=860671754 is handled. Duration 771 ms by bot id=7732473607
2025-03-17 22:14:24,405 - INFO - Update id=860671755 is handled. Duration 433 ms by bot id=7732473607
2025-03-17 22:16:23,649 - INFO - Подключение к базе данных установлено.
2025-03-17 22:16:23,960 - INFO - Таблицы проверены/созданы.
2025-03-17 22:16:24,268 - INFO - Индексы проверены/созданы.
2025-03-17 22:16:24,685 - INFO - Start polling
2025-03-17 22:16:24,778 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:16:26,516 - INFO - Получение названия группы пользователя.
2025-03-17 22:16:27,838 - INFO - Update id=860671756 is handled. Duration 1325 ms by bot id=7732473607
2025-03-17 22:16:29,909 - INFO - Update id=860671757 is handled. Duration 571 ms by bot id=7732473607
2025-03-17 22:16:57,903 - INFO - Получение названия группы пользователя.
2025-03-17 22:16:58,642 - INFO - Update id=860671758 is handled. Duration 741 ms by bot id=7732473607
2025-03-17 22:26:20,088 - INFO - Подключение к базе данных установлено.
2025-03-17 22:26:20,396 - INFO - Таблицы проверены/созданы.
2025-03-17 22:26:20,699 - INFO - Индексы проверены/созданы.
2025-03-17 22:26:21,054 - INFO - Start polling
2025-03-17 22:26:21,147 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:27:02,465 - INFO - Update id=860671759 is handled. Duration 750 ms by bot id=7732473607
2025-03-17 22:27:05,347 - INFO - Получение названия группы пользователя.
2025-03-17 22:27:06,414 - INFO - Update id=860671760 is handled. Duration 1069 ms by bot id=7732473607
2025-03-17 22:27:08,154 - INFO - Update id=860671761 is not handled. Duration 2 ms by bot id=7732473607
2025-03-17 22:27:08,154 - ERROR - Cause exception while process update id=860671761 by bot id=7732473607
ValidationError: 1 validation error for AnswerCallbackQuery
text
  Input should be a valid string [type=string_type, input_value=['2025-03-17'], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 71, in schedule_edit_date
    await callback_query.answer(text=text, show_alert=True)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/types/callback_query.py", line 102, in answer
    return AnswerCallbackQuery(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for AnswerCallbackQuery
text
  Input should be a valid string [type=string_type, input_value=['2025-03-17'], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-17 22:27:42,293 - INFO - Подключение к базе данных установлено.
2025-03-17 22:27:42,580 - INFO - Таблицы проверены/созданы.
2025-03-17 22:27:42,865 - INFO - Индексы проверены/созданы.
2025-03-17 22:27:43,209 - INFO - Start polling
2025-03-17 22:27:43,305 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:27:44,609 - INFO - Update id=860671762 is handled. Duration 726 ms by bot id=7732473607
2025-03-17 22:27:45,799 - INFO - Получение названия группы пользователя.
2025-03-17 22:27:46,781 - INFO - Update id=860671763 is handled. Duration 983 ms by bot id=7732473607
2025-03-17 22:27:48,589 - INFO - Update id=860671764 is not handled. Duration 2 ms by bot id=7732473607
2025-03-17 22:27:48,589 - ERROR - Cause exception while process update id=860671764 by bot id=7732473607
ValidationError: 1 validation error for AnswerCallbackQuery
text
  Input should be a valid string [type=string_type, input_value=['2025-03-17'], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 71, in schedule_edit_date
    await callback_query.answer(text=text, show_alert=True)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/types/callback_query.py", line 102, in answer
    return AnswerCallbackQuery(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for AnswerCallbackQuery
text
  Input should be a valid string [type=string_type, input_value=['2025-03-17'], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-17 22:28:21,037 - INFO - Подключение к базе данных установлено.
2025-03-17 22:28:21,329 - INFO - Таблицы проверены/созданы.
2025-03-17 22:28:21,613 - INFO - Индексы проверены/созданы.
2025-03-17 22:28:21,961 - INFO - Start polling
2025-03-17 22:28:22,061 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:28:25,558 - INFO - Update id=860671765 is handled. Duration 775 ms by bot id=7732473607
2025-03-17 22:28:28,583 - INFO - Получение названия группы пользователя.
2025-03-17 22:28:29,543 - INFO - Update id=860671766 is not handled. Duration 964 ms by bot id=7732473607
2025-03-17 22:28:29,543 - ERROR - Cause exception while process update id=860671766 by bot id=7732473607
TelegramBadRequest: Telegram server says - Bad Request: BUTTON_DATA_INVALID
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 116, in get_schedules
    await send_schedule_data(
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 63, in send_schedule_data
    await callback_query.message.edit_text(**pattern)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/methods/base.py", line 84, in emit
    return await bot(self)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/bot.py", line 498, in __call__
    return await self.session(self, method, timeout=request_timeout)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/aiohttp.py", line 185, in make_request
    response = self.check_response(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: BUTTON_DATA_INVALID
2025-03-17 22:32:38,459 - INFO - Подключение к базе данных установлено.
2025-03-17 22:32:38,766 - INFO - Таблицы проверены/созданы.
2025-03-17 22:32:39,068 - INFO - Индексы проверены/созданы.
2025-03-17 22:32:39,410 - INFO - Start polling
2025-03-17 22:32:39,531 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:32:40,256 - INFO - Получение названия группы пользователя.
2025-03-17 22:32:41,463 - INFO - Update id=860671767 is handled. Duration 1210 ms by bot id=7732473607
2025-03-17 22:32:42,579 - INFO - Update id=860671768 is not handled. Duration 2 ms by bot id=7732473607
2025-03-17 22:32:42,579 - ERROR - Cause exception while process update id=860671768 by bot id=7732473607
AttributeError: 'ScheduleManager' object has no attribute 'get_schedule_alert'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 73, in schedule_edit_date
    alert = await schedule_manager.get_schedule_alert(date)
AttributeError: 'ScheduleManager' object has no attribute 'get_schedule_alert'
2025-03-17 22:33:05,231 - INFO - Подключение к базе данных установлено.
2025-03-17 22:33:05,537 - INFO - Таблицы проверены/созданы.
2025-03-17 22:33:05,838 - INFO - Индексы проверены/созданы.
2025-03-17 22:33:06,187 - INFO - Start polling
2025-03-17 22:33:06,276 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:33:09,304 - INFO - Update id=860671769 is handled. Duration 835 ms by bot id=7732473607
2025-03-17 22:33:10,436 - INFO - Получение названия группы пользователя.
2025-03-17 22:33:11,480 - INFO - Update id=860671770 is handled. Duration 1046 ms by bot id=7732473607
2025-03-17 22:33:12,727 - INFO - Update id=860671771 is handled. Duration 565 ms by bot id=7732473607
2025-03-17 22:33:14,023 - INFO - Получение названия группы пользователя.
2025-03-17 22:33:14,798 - INFO - Update id=860671772 is handled. Duration 778 ms by bot id=7732473607
2025-03-17 22:33:16,733 - INFO - Update id=860671773 is not handled. Duration 302 ms by bot id=7732473607
2025-03-17 22:33:16,733 - ERROR - Cause exception while process update id=860671773 by bot id=7732473607
DataError: invalid input for query argument $1: '2025-03-19' ('str' object has no attribute 'toordinal')
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 97, in asyncpg.pgproto.pgproto.date_encode
AttributeError: 'str' object has no attribute 'toordinal'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 73, in schedule_edit_date
    alert = await schedule_manager.get_schedule_alert(date)
  File "/home/john/Documents/code/python/aiogram_pmk_bot/utils/db/schedule_manager.py", line 98, in get_schedule_alert
    return await self.pool.fetchval(query, date)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/pool.py", line 615, in fetchval
    return await con.fetchval(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 714, in fetchval
    data = await self._execute(query, args, 1, timeout)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: '2025-03-19' ('str' object has no attribute 'toordinal')
2025-03-17 22:34:12,035 - INFO - Подключение к базе данных установлено.
2025-03-17 22:34:12,330 - INFO - Таблицы проверены/созданы.
2025-03-17 22:34:12,622 - INFO - Индексы проверены/созданы.
2025-03-17 22:34:12,964 - INFO - Start polling
2025-03-17 22:34:13,053 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:34:15,883 - INFO - Update id=860671774 is handled. Duration 716 ms by bot id=7732473607
2025-03-17 22:34:19,709 - INFO - Update id=860671775 is handled. Duration 388 ms by bot id=7732473607
2025-03-17 22:34:24,197 - INFO - Update id=860671776 is handled. Duration 636 ms by bot id=7732473607
2025-03-17 22:34:25,249 - INFO - Получение названия группы пользователя.
2025-03-17 22:34:26,256 - INFO - Update id=860671777 is handled. Duration 1009 ms by bot id=7732473607
2025-03-17 22:34:27,940 - INFO - Update id=860671778 is handled. Duration 551 ms by bot id=7732473607
2025-03-17 22:34:29,286 - INFO - Получение названия группы пользователя.
2025-03-17 22:34:29,979 - INFO - Update id=860671779 is handled. Duration 695 ms by bot id=7732473607
2025-03-17 22:34:31,276 - INFO - Update id=860671780 is handled. Duration 444 ms by bot id=7732473607
2025-03-17 22:36:21,219 - INFO - Подключение к базе данных установлено.
2025-03-17 22:36:21,505 - INFO - Таблицы проверены/созданы.
2025-03-17 22:36:21,788 - INFO - Индексы проверены/созданы.
2025-03-17 22:36:22,130 - INFO - Start polling
2025-03-17 22:36:22,220 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:36:25,925 - INFO - Update id=860671781 is not handled. Duration 732 ms by bot id=7732473607
2025-03-17 22:36:25,925 - ERROR - Cause exception while process update id=860671781 by bot id=7732473607
TelegramBadRequest: Telegram server says - Bad Request: MESSAGE_TOO_LONG
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 75, in schedule_edit_date
    await callback_query.answer(text=alert, show_alert=True)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/methods/base.py", line 84, in emit
    return await bot(self)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/bot.py", line 498, in __call__
    return await self.session(self, method, timeout=request_timeout)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/aiohttp.py", line 185, in make_request
    response = self.check_response(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/client/session/base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: MESSAGE_TOO_LONG
2025-03-17 22:37:02,091 - INFO - Подключение к базе данных установлено.
2025-03-17 22:37:02,386 - INFO - Таблицы проверены/созданы.
2025-03-17 22:37:02,677 - INFO - Индексы проверены/созданы.
2025-03-17 22:37:03,030 - INFO - Start polling
2025-03-17 22:37:03,128 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:37:04,956 - INFO - Update id=860671782 is handled. Duration 781 ms by bot id=7732473607
2025-03-17 22:39:20,619 - INFO - Подключение к базе данных установлено.
2025-03-17 22:39:20,920 - INFO - Таблицы проверены/созданы.
2025-03-17 22:39:21,217 - INFO - Индексы проверены/созданы.
2025-03-17 22:39:21,557 - INFO - Start polling
2025-03-17 22:39:21,649 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:39:23,175 - INFO - Update id=860671783 is handled. Duration 779 ms by bot id=7732473607
2025-03-17 22:39:24,525 - INFO - Получение названия группы пользователя.
2025-03-17 22:39:25,683 - INFO - Update id=860671784 is handled. Duration 1160 ms by bot id=7732473607
2025-03-17 22:39:26,932 - INFO - Update id=860671785 is handled. Duration 562 ms by bot id=7732473607
2025-03-17 22:39:28,451 - INFO - Получение названия группы пользователя.
2025-03-17 22:39:29,154 - INFO - Update id=860671786 is handled. Duration 706 ms by bot id=7732473607
2025-03-17 22:39:31,179 - INFO - Update id=860671787 is handled. Duration 577 ms by bot id=7732473607
2025-03-17 22:39:33,245 - INFO - Получение названия группы пользователя.
2025-03-17 22:39:33,963 - INFO - Update id=860671788 is handled. Duration 719 ms by bot id=7732473607
2025-03-17 22:39:37,661 - INFO - Update id=860671789 is handled. Duration 496 ms by bot id=7732473607
2025-03-17 22:39:39,919 - INFO - Получение названия группы пользователя.
2025-03-17 22:39:40,654 - INFO - Update id=860671790 is handled. Duration 737 ms by bot id=7732473607
2025-03-17 22:39:47,925 - INFO - Update id=860671791 is handled. Duration 509 ms by bot id=7732473607
2025-03-17 22:39:48,973 - INFO - Получение названия группы пользователя.
2025-03-17 22:39:49,769 - INFO - Update id=860671792 is handled. Duration 799 ms by bot id=7732473607
2025-03-17 22:40:13,072 - INFO - Подключение к базе данных установлено.
2025-03-17 22:40:13,380 - INFO - Таблицы проверены/созданы.
2025-03-17 22:40:13,686 - INFO - Индексы проверены/созданы.
2025-03-17 22:40:14,052 - INFO - Start polling
2025-03-17 22:40:14,149 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 22:40:16,098 - INFO - Update id=860671793 is handled. Duration 806 ms by bot id=7732473607
2025-03-17 22:40:17,230 - INFO - Получение названия группы пользователя.
2025-03-17 22:40:18,277 - INFO - Update id=860671794 is handled. Duration 1051 ms by bot id=7732473607
2025-03-17 22:40:19,783 - INFO - Update id=860671795 is handled. Duration 608 ms by bot id=7732473607
2025-03-17 22:40:20,721 - INFO - Получение названия группы пользователя.
2025-03-17 22:40:21,544 - INFO - Update id=860671796 is handled. Duration 825 ms by bot id=7732473607
2025-03-17 22:40:24,420 - INFO - Update id=860671797 is handled. Duration 569 ms by bot id=7732473607
2025-03-17 23:17:26,126 - INFO - Подключение к базе данных установлено.
2025-03-17 23:17:26,438 - INFO - Таблицы проверены/созданы.
2025-03-17 23:17:26,828 - INFO - Индексы проверены/созданы.
2025-03-17 23:17:27,208 - INFO - Start polling
2025-03-17 23:17:27,304 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 23:25:16,843 - INFO - Подключение к базе данных установлено.
2025-03-17 23:25:17,171 - INFO - Таблицы проверены/созданы.
2025-03-17 23:25:17,495 - INFO - Индексы проверены/созданы.
2025-03-17 23:26:20,579 - INFO - Подключение к базе данных установлено.
2025-03-17 23:26:20,891 - INFO - Таблицы проверены/созданы.
2025-03-17 23:26:21,202 - INFO - Индексы проверены/созданы.
2025-03-17 23:26:21,588 - INFO - Start polling
2025-03-17 23:26:21,687 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 23:26:23,767 - INFO - Получение названия группы пользователя.
2025-03-17 23:26:25,006 - INFO - Update id=860671798 is handled. Duration 1241 ms by bot id=7732473607
2025-03-17 23:26:32,922 - INFO - Update id=860671799 is not handled. Duration 2 ms by bot id=7732473607
2025-03-17 23:26:32,922 - ERROR - Cause exception while process update id=860671799 by bot id=7732473607
TypeError: Connection.__init__() got an unexpected keyword argument 'passowrd'
Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aioredis/connection.py", line 1409, in get_connection
    connection = self._available_connections.pop()
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/callbacks/schedule.py", line 89, in schedule_edit_date
    date_list = await schedule_manager.get_schedule_date()
  File "/home/john/Documents/code/python/aiogram_pmk_bot/utils/db/schedule_manager.py", line 81, in get_schedule_date
    cached_data = await self.cache.get(cache_key)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aioredis/client.py", line 1082, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aioredis/connection.py", line 1411, in get_connection
    connection = self.make_connection()
  File "/home/john/.cache/pypoetry/virtualenvs/aiogram-pmk-bot-L9WIEWYH-py3.10/lib/python3.10/site-packages/aioredis/connection.py", line 1451, in make_connection
    return self.connection_class(**self.connection_kwargs)
TypeError: Connection.__init__() got an unexpected keyword argument 'passowrd'
2025-03-17 23:28:42,843 - INFO - Подключение к базе данных установлено.
2025-03-17 23:28:43,164 - INFO - Таблицы проверены/созданы.
2025-03-17 23:28:43,480 - INFO - Индексы проверены/созданы.
2025-03-17 23:28:43,860 - INFO - Start polling
2025-03-17 23:28:43,959 - INFO - Run polling for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 23:28:47,319 - INFO - Update id=860671800 is handled. Duration 794 ms by bot id=7732473607
2025-03-17 23:28:48,497 - INFO - Получение названия группы пользователя.
2025-03-17 23:28:49,600 - INFO - Update id=860671801 is handled. Duration 1105 ms by bot id=7732473607
2025-03-17 23:28:51,475 - INFO - Update id=860671802 is handled. Duration 631 ms by bot id=7732473607
2025-03-17 23:28:54,287 - INFO - Получение названия группы пользователя.
2025-03-17 23:28:55,039 - INFO - Update id=860671803 is handled. Duration 763 ms by bot id=7732473607
2025-03-17 23:29:24,944 - INFO - Update id=860671804 is handled. Duration 504 ms by bot id=7732473607
2025-03-17 23:29:35,472 - WARNING - Received SIGINT signal
2025-03-17 23:29:35,473 - INFO - Polling stopped for bot @affine_test_bot id=7732473607 - 'affine'
2025-03-17 23:29:35,473 - INFO - Polling stopped
2025-03-17 23:29:35,887 - INFO - Подключение к базе данных закрыто.
